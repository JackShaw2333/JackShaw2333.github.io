<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Ubuntu Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://yoursite.com').hostname,
    root: '/',
    scheme: 'Mist',
    version: '7.5.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="From 2020 S&amp;P.">
<meta property="og:type" content="article">
<meta property="og:title" content="SAVIOR: Towards Bug-Driven Hybrid Testing">
<meta property="og:url" content="http://yoursite.com/2021/10/18/SAVIOR-Towards-Bug-Driven-Hybrid-Testing/index.html">
<meta property="og:site_name" content="xBug">
<meta property="og:description" content="From 2020 S&amp;P.">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-10-18T11:01:54.000Z">
<meta property="article:modified_time" content="2021-10-18T11:01:54.000Z">
<meta property="article:author" content="Jared Shaw">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/2021/10/18/SAVIOR-Towards-Bug-Driven-Hybrid-Testing/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>SAVIOR: Towards Bug-Driven Hybrid Testing | xBug</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">xBug</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/10/18/SAVIOR-Towards-Bug-Driven-Hybrid-Testing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jared Shaw">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xBug">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SAVIOR: Towards Bug-Driven Hybrid Testing
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-18 19:01:54" itemprop="dateCreated datePublished" datetime="2021-10-18T19:01:54+08:00">2021-10-18</time>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>From 2020 S&amp;P.</p>
<span id="more"></span>
<h2 id="1-Abstract"><a href="#1-Abstract" class="headerlink" title="1. Abstract"></a>1. Abstract</h2><p>Despite of recent significant advancement, hybrid testing’s code coverage-centric design is inefficient in vulnerability detection in that it a) blindly selects seeds, and b) quickly moves on after reaching a chunk without examining hidden defects.</p>
<p>SAVIOR, a bug-driven framework is proposed, prioritizing promising seeds and verifying all vulnerable spots along the path. By modeling faulty situations in SMT constraints, SAVIOR reasons the feasibility and generates test case as proofs.</p>
<p>SAVIOR outperforms mainstream techniques by about 40% faster in vulnerability detection and finds about 80 unique bugs.</p>
<h2 id="2-Introduction"><a href="#2-Introduction" class="headerlink" title="2. Introduction"></a>2. Introduction</h2><p>Fuzzing hardly dive into regions with complex conditions. Concolic execution frequently directs to branchs with many exec paths.</p>
<p>Typically, a hybrid approach runs fuzzer most until it make no progress. Then concolic execution re-run the seeds from fuzzing. Generally, it use concolic to guide fuzzer.</p>
<p>2 novel techniques in SAVIOR:</p>
<ul>
<li>bug-driven prioritization: before testing, SAVIOR analyzes the source code and statically labels the potential vulnerable spots. During dynamic testing, it prioritizes seeds reaching more labels. This technique make SAVIOR faster by about 40%.</li>
<li>bug-guided verification: verifies the labeled vulnerability along the path traversed by the concolic executor.</li>
</ul>
<h2 id="3-Design"><a href="#3-Design" class="headerlink" title="3. Design"></a>3. Design</h2><h3 id="3-1-Core-techniques"><a href="#3-1-Core-techniques" class="headerlink" title="3.1. Core techniques"></a>3.1. Core techniques</h3><h4 id="3-1-1-Bug-driven-prioritization"><a href="#3-1-1-Bug-driven-prioritization" class="headerlink" title="3.1.1. Bug-driven prioritization"></a>3.1.1. Bug-driven prioritization</h4><p>Need to predict the amount of vulnerabilities a seed can expose. Thus, 2 prerequisites are needed:</p>
<ul>
<li>R1: method to assess the reachable code region after a seed is run on. During compilation, the set of reachable regions from each branch is computed. At runtime, unexplored branches of a seed’s execution path are identified, which are deemed as explorable regions.</li>
<li>R2: metric to quantify the amount of vulnerabilities of a code chunk. UBSan is utilized to annotate potential bugs, and UBSan labels filtered statically after in each region is summed as R2.</li>
</ul>
<h4 id="3-1-2-Bug-guided-verification"><a href="#3-1-2-Bug-guided-verification" class="headerlink" title="3.1.2. Bug-guided verification"></a>3.1.2. Bug-guided verification</h4><h3 id="3-2-System-design"><a href="#3-2-System-design" class="headerlink" title="3.2. System design"></a>3.2. System design</h3><h4 id="3-2-1-Compilation-tool-chain"><a href="#3-2-1-Compilation-tool-chain" class="headerlink" title="3.2.1. Compilation tool-chain"></a>3.2.1. Compilation tool-chain</h4><h5 id="3-2-1-1-Sound-vul-labeling"><a href="#3-2-1-1-Sound-vul-labeling" class="headerlink" title="3.2.1.1. Sound vul labeling"></a>3.2.1.1. Sound vul labeling</h5><p>SAVIOR can use other sanitizers as long as they satify the following 2 properties:</p>
<ul>
<li>able to annotate the vulnerabilities</li>
<li>able to synthesize the triggering condition, which must have data dependency on input, of each labeled vul</li>
</ul>
<p>The static filter in R2 trims a label meeting 3 requirements. As a result, on average about 5% labels are removed.</p>
<h5 id="3-2-1-2-Reachability-analysis"><a href="#3-2-1-2-Reachability-analysis" class="headerlink" title="3.2.1.2. Reachability analysis"></a>3.2.1.2. Reachability analysis</h5><p>Counts # of vul labels that can be forwardly reached by each BB in CFG. 2 phases:</p>
<ul>
<li>construct an inter-procedure CFG</li>
<li>count UBSan labels reachable from each BB</li>
</ul>
<h5 id="3-2-1-3-Target-building"><a href="#3-2-1-3-Target-building" class="headerlink" title="3.2.1.3. Target building"></a>3.2.1.3. Target building</h5><p>3 binaries are compiled:</p>
<ul>
<li>fuzzer</li>
<li>coordinator</li>
<li>concolic executor</li>
</ul>
<h4 id="3-2-2-Coordinator"><a href="#3-2-2-Coordinator" class="headerlink" title="3.2.2. Coordinator"></a>3.2.2. Coordinator</h4><h5 id="3-2-2-1-Bug-driven-prioritization"><a href="#3-2-2-1-Bug-driven-prioritization" class="headerlink" title="3.2.2.1. Bug-driven prioritization"></a>3.2.2.1. Bug-driven prioritization</h5><p>In a polling round, coordinator feeds each new seed from last round to SAVIOR-binary and updates 2 info:</p>
<ul>
<li>global coverage info</li>
<li>the seq of BBs visited by each seed</li>
</ul>
<p>With these info, coordinator assign scores for seeds. All seeds will be rescored except those already tested by the concolic executor.</p>
<p>Finally, top-ranked seeds are selected.</p>
<h5 id="3-2-2-2-Post-processing-of-concolic-execution"><a href="#3-2-2-2-Post-processing-of-concolic-execution" class="headerlink" title="3.2.2.2. Post-processing of concolic execution"></a>3.2.2.2. Post-processing of concolic execution</h5><p>coordinator triage new seeds by concolic executor for the fuzzer and:</p>
<ol>
<li>rerun new seeds and retain those with new coverage or can reach uncovered labels. Transfer them to fuzzer</li>
<li>update # of attempts on uncovered branches.</li>
</ol>
<h4 id="3-2-3-Concolic-executor"><a href="#3-2-3-Concolic-executor" class="headerlink" title="3.2.3. Concolic executor"></a>3.2.3. Concolic executor</h4><p>replay seeds and chooses to solve branches based on coverage info. Also, it performs bug-guided verification.</p>
<h5 id="3-2-3-1-Independent-coverage-scheme"><a href="#3-2-3-1-Independent-coverage-scheme" class="headerlink" title="3.2.3.1. Independent coverage scheme"></a>3.2.3.1. Independent coverage scheme</h5><p>Use KLEE’s internal coverage info.</p>
<h5 id="3-2-3-2-Fork-Server-mode"><a href="#3-2-3-2-Fork-Server-mode" class="headerlink" title="3.2.3.2. Fork Server mode"></a>3.2.3.2. Fork Server mode</h5><p>Because KLEE’s initialization takes too long, thus an optim is introduced named <em>fork server</em>.</p>
<h5 id="3-2-3-3-Bug-guided-verification"><a href="#3-2-3-3-Bug-guided-verification" class="headerlink" title="3.2.3.3. Bug-guided verification"></a>3.2.3.3. Bug-guided verification</h5><p>If the triggering constraint of a non-covered label is solved, KLEE generates a seed as the proof of the vul.</p>
<p>If path constraints conflict with vul triggering conditions, QSYM’s approach is adopted. But relaxed-constraints may produce FP, in which situation a vul labeled is not deemed as covered.</p>
<h5 id="3-2-3-4-Timeout-on-concolic-execution"><a href="#3-2-3-4-Timeout-on-concolic-execution" class="headerlink" title="3.2.3.4. Timeout on concolic execution"></a>3.2.3.4. Timeout on concolic execution</h5><p>Timeout threshold of a seed is set to be proportional to the # of uncovered branches it can reach.</p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/09/25/log-sum-exp%E5%87%BD%E6%95%B0/" rel="prev" title="log-sum-exp函数">
      <i class="fa fa-chevron-left"></i> log-sum-exp函数
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/10/28/Dangling-else-problem/" rel="next" title="Dangling else problem">
      Dangling else problem <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Abstract"><span class="nav-number">1.</span> <span class="nav-text">1. Abstract</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-Introduction"><span class="nav-number">2.</span> <span class="nav-text">2. Introduction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-Design"><span class="nav-number">3.</span> <span class="nav-text">3. Design</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-Core-techniques"><span class="nav-number">3.1.</span> <span class="nav-text">3.1. Core techniques</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-1-Bug-driven-prioritization"><span class="nav-number">3.1.1.</span> <span class="nav-text">3.1.1. Bug-driven prioritization</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-2-Bug-guided-verification"><span class="nav-number">3.1.2.</span> <span class="nav-text">3.1.2. Bug-guided verification</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-System-design"><span class="nav-number">3.2.</span> <span class="nav-text">3.2. System design</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-1-Compilation-tool-chain"><span class="nav-number">3.2.1.</span> <span class="nav-text">3.2.1. Compilation tool-chain</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-1-1-Sound-vul-labeling"><span class="nav-number">3.2.1.1.</span> <span class="nav-text">3.2.1.1. Sound vul labeling</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-1-2-Reachability-analysis"><span class="nav-number">3.2.1.2.</span> <span class="nav-text">3.2.1.2. Reachability analysis</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-1-3-Target-building"><span class="nav-number">3.2.1.3.</span> <span class="nav-text">3.2.1.3. Target building</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-2-Coordinator"><span class="nav-number">3.2.2.</span> <span class="nav-text">3.2.2. Coordinator</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-2-1-Bug-driven-prioritization"><span class="nav-number">3.2.2.1.</span> <span class="nav-text">3.2.2.1. Bug-driven prioritization</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-2-2-Post-processing-of-concolic-execution"><span class="nav-number">3.2.2.2.</span> <span class="nav-text">3.2.2.2. Post-processing of concolic execution</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-3-Concolic-executor"><span class="nav-number">3.2.3.</span> <span class="nav-text">3.2.3. Concolic executor</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-3-1-Independent-coverage-scheme"><span class="nav-number">3.2.3.1.</span> <span class="nav-text">3.2.3.1. Independent coverage scheme</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-3-2-Fork-Server-mode"><span class="nav-number">3.2.3.2.</span> <span class="nav-text">3.2.3.2. Fork Server mode</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-3-3-Bug-guided-verification"><span class="nav-number">3.2.3.3.</span> <span class="nav-text">3.2.3.3. Bug-guided verification</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-3-4-Timeout-on-concolic-execution"><span class="nav-number">3.2.3.4.</span> <span class="nav-text">3.2.3.4. Timeout on concolic execution</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Jared Shaw</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">76</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jared Shaw</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v5.4.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.5.0
  </div>


    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  
















  

  

  

</body>
</html>
